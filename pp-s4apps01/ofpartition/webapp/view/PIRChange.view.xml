<mvc:View
    controllerName="pp.ofpartition.controller.PIRChange"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:unified="sap.ui.unified"
    xmlns:upload="sap.m.upload"
    xmlns:t="sap.ui.table"
    xmlns:rm="sap.ui.table.rowmodes"
    xmlns:layout="sap.ui.layout"
>
    <VBox
        id="idVBox"
        fitContainer="true"
    >
        <!-- <Panel
            id="idPanel"
            expandable="true"
            headerText="{i18n>templateText}"
            width="auto"
        >
            <upload:UploadSet
                id="idUploadSet"
                items="{Attach>DocumentInfoRecordToAttachmentNavigation}"
                multiple="false"
                mode="None"
                uploadEnabled="false"
                uploadButtonInvisible="true"
                instantUpload="false"
            >
                <upload:items>
                    <upload:UploadSetItem
                        id="idUploadSetItem"
                        fileName="{Attach>FileName}"
                        mediaType="{Attach>MimeType}"
                        url="{
                            path: 'Attach>__metadata/media_src',
                            formatter: '.getMediaUrl'
                        }"
                        visibleEdit="false"
                        visibleRemove="false"
                    />
                </upload:items>
            </upload:UploadSet>
        </Panel> -->
        <Panel
            id="idFileUploadPanel"
            expandable="true"
            expanded="true"
            headerText="{i18n>uploadText}"
            width="auto"
        >
            <unified:FileUploader
                id="idFileUploader"
                fileType="xlsx,xls"
                change="onFileUploaderChange"
                width="40%"
                class="sapUiSmallMargin"
                sameFilenameAllowed="true"
            />
        </Panel>
        <Panel
            id="id0Panel"
            expandable="true"
            expanded="true"
            headerText="{i18n>result}"
            width="auto"
            height="100%"
        >
            <layoutData>
                <FlexItemData
                    id="idFlexItemData"
                    maxHeight="100%"
                    maxWidth="100%"
                    growFactor="1"
                />
            </layoutData>
            <t:Table
                id="idUploadTable"
                rows="{local>/excelSet}"
                selectionMode="Multi"
                class="sapUiSizeCompact"
            >
                <t:rowMode>
                    <rm:Auto />
                </t:rowMode>
                <t:extension>
                    <OverflowToolbar>
                        <Text
                            text="{local>/logInfo}"
                        />
                        <ToolbarSpacer />
                        <Button
                            id="idCheckRecords"
                            icon="sap-icon://check-availability"
                            type="Transparent"
                            text="{i18n>btnCheckRecords}"
                            press="onCheckRecords"
                            enabled="{= ${local>/excelSet}.length > 0}"
                        />
                        <Button
                            id="idCheckButton"
                            icon="sap-icon://save"
                            type="Transparent"
                            text="{i18n>btnPIRChange}"
                            press="onPIRChange"
                            enabled="{local>/isRecordCheckSuccessed}"
                        />
                        <Button 
                            icon="sap-icon://excel-attachment"
                            type="Transparent"
                            press="onExport"
                            enabled="{= ${local>/excelSet}.length > 0}"
                        />
                    </OverflowToolbar>
                </t:extension>
                <t:columns>
                    <t:Column
                        id="id36Column"
                        width="6rem"
                        sortProperty="Type"
                        hAlign="Center"
                        label="{i18n>Status}"
                    >
                        <t:template>
                            <ObjectStatus
                                id="idObjectStatus"
                                state="{
                                    path: 'local>Type',
                                    formatter: '.formatter.setState'
                                }"
                                icon="{
                                    path: 'local>Type',
                                    formatter: '.formatter.setStateIcon'
                                }"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        width="12rem"
                        sortProperty="Message"
                        label="{i18n>Message}"
                    >
                        <t:template>
                            <Text
                                id="idMessageText"
                                text="{local>Message}"
                                tooltip="{local>Message}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        width="8rem"
                        sortProperty="Customer"
                        label="{i18n>Customer}"
                    >
                        <t:template>
                            <Text
                                text="{local>Customer}"
                                tooltip="{local>Customer}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        width="5rem"
                        sortProperty="Plant"
                        label="{i18n>Plant}"
                    >
                        <t:template>
                            <Text
                                text="{local>Plant}"
                                tooltip="{local>Plant}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        width="10rem"
                        sortProperty="Material"
                        label="{i18n>Material}"
                    >
                        <t:template>
                            <Text
                                text="{local>Material}"
                                tooltip="{local>Material}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        width="10rem"
                        sortProperty="MaterialByCustomer"
                        label="{i18n>MaterialByCustomer}"
                    >
                        <t:template>
                            <Text
                                text="{local>MaterialByCustomer}"
                                tooltip="{local>MaterialByCustomer}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        width="12rem"
                        sortProperty="MaterialName"
                        label="{i18n>MaterialName}"
                    >
                        <t:template>
                            <Text
                                text="{local>MaterialName}"
                                tooltip="{local>MaterialName}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                </t:columns>
            </t:Table>
        </Panel>
    </VBox>
</mvc:View>