<mvc:View
    controllerName="mm.uploadpurchasereq.controller.Upload"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:unified="sap.ui.unified"
    xmlns:upload="sap.m.upload"
    xmlns:t="sap.ui.table"
    xmlns:rm="sap.ui.table.rowmodes"
    xmlns:layout="sap.ui.layout"
>
    <VBox
        id="idVBox"
        fitContainer="true"
    >
        <Panel
            id="idPanel"
            expandable="true"
            headerText="{i18n>templateText}"
            width="auto"
        >
            <upload:UploadSet
                id="idUploadSet"
                items="{Attach>DocumentInfoRecordToAttachmentNavigation}"
                multiple="false"
                mode="None"
                uploadEnabled="false"
                uploadButtonInvisible="true"
                instantUpload="false"
            >
                <upload:items>
                    <upload:UploadSetItem
                        id="idUploadSetItem"
                        fileName="{Attach>FileName}"
                        mediaType="{Attach>MimeType}"
                        url="{
                            path: 'Attach>__metadata/media_src',
                            formatter: '.getMediaUrl'
                        }"
                        visibleEdit="false"
                        visibleRemove="false"
                    />
                </upload:items>
            </upload:UploadSet>
        </Panel>
        <Panel
            id="idFileUploadPanel"
            expandable="true"
            expanded="true"
            headerText="{i18n>uploadText}"
            width="auto"
        >
            <unified:FileUploader
                id="idFileUploader"
                fileType="xlsx,xls"
                change="onFileUploaderChange"
                width="40%"
                class="sapUiSmallMargin"
                sameFilenameAllowed="true"
            />
        </Panel>
        <Panel
            id="id0Panel"
            expandable="true"
            expanded="true"
            headerText="{i18n>result}"
            width="auto"
            height="100%"
        >
            <layoutData>
                <FlexItemData
                    id="idFlexItemData"
                    maxHeight="100%"
                    maxWidth="100%"
                    growFactor="1"
                />
            </layoutData>
            <t:Table
                id="idTable"
                rows="{local>/excelSet}"
                selectionMode="Multi"
                class="sapUiSizeCompact"
            >
                <t:rowMode>
                    <rm:Auto id="idAuto" />
                </t:rowMode>
                <t:extension>
                    <OverflowToolbar id="idOverflowToolbar">
                        <Text
                            id="idLogInfoText"
                            text="{local>/logInfo}"
                        />
                        <ToolbarSpacer id="idToolbarSpacer" />
                        <Button
                            id="idCheckButton"
                            icon="sap-icon://check-availability"
                            type="Transparent"
                            text="{i18n>UploadView.checkBtn}"
                            press=".onButtonPress($event, 'check')"
                            visible="{= ${local>/excelSet}.length > 0}"
                        />
                        <Button
                            id="idSaveButton"
                            icon="sap-icon://document"
                            type="Transparent"
                            text="{i18n>UploadView.saveBtn}"
                            press=".onButtonPress($event, 'save')"
                            visible="{= ${local>/excelSet}.length > 0}"
                            enabled="{local>/recordCheckSuccessed}"
                        />
                        <Button
                            id="idDownloadButton"
                            icon="sap-icon://excel-attachment"
                            type="Transparent"
                            text="{i18n>UploadView.DownloadBtn}"
                            press="onExport"
                            enabled="{= ${local>/excelSet}.length > 0}"
                        />
                    </OverflowToolbar>
                </t:extension>
                <t:columns>
                    <t:Column
                        id="id36Column"
                        width="6rem"
                        sortProperty="Type"
                        hAlign="Center"
                        label="{i18n>Status}"
                    >
                        <t:template>
                            <ObjectStatus
                                id="idObjectStatus"
                                state="{
                                    path: 'local>Type',
                                    formatter: '.formatter.setState'
                                }"
                                icon="{
                                    path: 'local>Type',
                                    formatter: '.formatter.setStateIcon'
                                }"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id37Column"
                        width="5rem"
                        sortProperty="Result"
                        label="{i18n>Result}"
                    >
                        <t:template>
                            <Text
                                id="idTypeText"
                                text="{
                                    path: 'local>Type',
                                    formatter: '.formatter.setResult'
                                }"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id38Column"
                        width="14rem"
                        sortProperty="Message"
                        label="{i18n>Message}"
                    >
                        <t:template>
                            <Text
                                id="idMessageText"
                                text="{local>Message}"
                                tooltip="{local>Message}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id35Column"
                        width="8rem"
                        label="{i18n>ApplyDepart}"
                    >
                        <t:template>
                            <Text
                                id="idApplyDepartText"
                                text="{local>ApplyDepart}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="idColumn"
                        width="8rem"
                        label="{i18n>PrNo}"
                    >
                        <t:template>
                            <Text
                                id="idPrNoText"
                                text="{local>PrNo}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id42Column"
                        width="6rem"
                        label="{i18n>PrItem}"
                    >
                        <t:template>
                            <Text
                                id="idPrItemText"
                                text="{local>PrItem}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id0Column"
                        width="8rem"
                        label="{i18n>PrType}"
                    >
                        <t:template>
                            <Text
                                id="idPrTypeText"
                                text="{local>PrType}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id1Column"
                        width="8rem"
                        label="{i18n>OrderType}"
                    >
                        <t:template>
                            <Text
                                id="idOrderTypeText"
                                text="{local>OrderType}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id41Column"
                        width="6rem"
                        label="{i18n>Kyoten}"
                    >
                        <t:template>
                            <Text
                                id="idKyotenText"
                                text="{local>Kyoten}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id34Column"
                        width="8rem"
                        label="{i18n>IsLink}"
                    >
                        <t:template>
                            <Text
                                id="idIsLinkText"
                                text="{local>IsLink}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        width="6rem"
                        label="{i18n>IsApprove}"
                    >
                        <t:template>
                            <Text
                                text="{local>IsApprove}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id2Column"
                        width="8rem"
                        label="{i18n>Supplier}"
                    >
                        <t:template>
                            <Text
                                id="idSupplierText"
                                text="{local>Supplier}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id3Column"
                        width="8rem"
                        label="{i18n>CompanyCode}"
                    >
                        <t:template>
                            <Text
                                id="idCompanyCodeText"
                                text="{local>CompanyCode}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id4Column"
                        width="8rem"
                        label="{i18n>PurchaseOrg}"
                    >
                        <t:template>
                            <Text
                                id="idPurchaseOrgText"
                                text="{local>PurchaseOrg}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id5Column"
                        width="8rem"
                        label="{i18n>PurchaseGrp}"
                    >
                        <t:template>
                            <Text
                                id="idPurchaseGrpText"
                                text="{local>PurchaseGrp}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id6Column"
                        width="8rem"
                        label="{i18n>Plant}"
                    >
                        <t:template>
                            <Text
                                id="idPlantText"
                                text="{local>Plant}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id7Column"
                        width="8rem"
                        label="{i18n>Currency}"
                    >
                        <t:template>
                            <Text
                                id="idCurrencyText"
                                text="{local>Currency}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id8Column"
                        width="8rem"
                        label="{i18n>ItemCategory}"
                    >
                        <t:template>
                            <Text
                                id="idItemCategoryText"
                                text="{local>ItemCategory}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id9Column"
                        width="8rem"
                        label="{i18n>AccountType}"
                    >
                        <t:template>
                            <Text
                                id="idAccountTypeText"
                                text="{local>AccountType}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id10Column"
                        width="8rem"
                        label="{i18n>MatID}"
                    >
                        <t:template>
                            <Text
                                id="idMatIDText"
                                text="{local>MatID}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id11Column"
                        width="8rem"
                        label="{i18n>MatDesc}"
                    >
                        <t:template>
                            <Text
                                id="idMatDescText"
                                text="{local>MatDesc}"
                                tooltip="{local>MatDesc}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id12Column"
                        width="8rem"
                        label="{i18n>MaterialGroup}"
                    >
                        <t:template>
                            <Text
                                id="idMaterialGroupText"
                                text="{local>MaterialGroup}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id13Column"
                        width="8rem"
                        label="{i18n>Quantity}"
                    >
                        <t:template>
                            <Text
                                id="idQuantityText"
                                text="{local>Quantity}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id14Column"
                        width="8rem"
                        label="{i18n>Unit}"
                    >
                        <t:template>
                            <Text
                                id="idUnitText"
                                text="{local>Unit}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id15Column"
                        width="8rem"
                        label="{i18n>Price}"
                    >
                        <t:template>
                            <Text
                                id="idPriceText"
                                text="{local>Price}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id16Column"
                        width="8rem"
                        label="{i18n>UnitPrice}"
                    >
                        <t:template>
                            <Text
                                id="idUnitPriceText"
                                text="{local>UnitPrice}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id17Column"
                        width="8rem"
                        label="{i18n>DeliveryDate}"
                    >
                        <t:template>
                            <Text
                                id="idDeliveryDateText"
                                text="{path:'local>DeliveryDate', formatter:'.formatter.date'}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id18Column"
                        width="8rem"
                        label="{i18n>Location}"
                    >
                        <t:template>
                            <Text
                                id="idLocationText"
                                text="{local>Location}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id19Column"
                        width="8rem"
                        label="{i18n>ReturnItem}"
                    >
                        <t:template>
                            <Text
                                id="idReturnItemText"
                                text="{local>ReturnItem}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id20Column"
                        width="8rem"
                        label="{i18n>Free}"
                    >
                        <t:template>
                            <Text
                                id="idFreeText"
                                text="{local>Free}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id21Column"
                        width="8rem"
                        label="{i18n>GlAccount}"
                    >
                        <t:template>
                            <Text
                                id="idGlAccountText"
                                text="{local>GlAccount}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id22Column"
                        width="8rem"
                        label="{i18n>CostCenter}"
                    >
                        <t:template>
                            <Text
                                id="idCostCenterText"
                                text="{local>CostCenter}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id23Column"
                        width="8rem"
                        label="{i18n>WbsElemnt}"
                    >
                        <t:template>
                            <Text
                                id="idWbsElemntText"
                                text="{local>WbsElemnt}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id24Column"
                        width="8rem"
                        label="{i18n>AssetNo}"
                    >
                        <t:template>
                            <Text
                                id="idAssetNoText"
                                text="{local>AssetNo}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id25Column"
                        width="8rem"
                        label="{i18n>Tax}"
                    >
                        <t:template>
                            <Text
                                id="idTaxText"
                                text="{local>Tax}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id26Column"
                        width="8rem"
                        label="{i18n>ItemText}"
                    >
                        <t:template>
                            <Text
                                id="idItemTextText"
                                text="{local>ItemText}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id27Column"
                        width="8rem"
                        label="{i18n>PrBy}"
                    >
                        <t:template>
                            <Text
                                id="idPrByText"
                                text="{local>PrBy}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id28Column"
                        width="8rem"
                        label="{i18n>TrackNo}"
                    >
                        <t:template>
                            <Text
                                id="idTrackNoText"
                                text="{local>TrackNo}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id29Column"
                        width="8rem"
                        label="{i18n>Ean}"
                    >
                        <t:template>
                            <Text
                                id="idEanText"
                                text="{local>Ean}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id30Column"
                        width="8rem"
                        label="{i18n>CustomerRec}"
                    >
                        <t:template>
                            <Text
                                id="idCustomerRecText"
                                text="{local>CustomerRec}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id31Column"
                        width="8rem"
                        label="{i18n>AssetOri}"
                    >
                        <t:template>
                            <Text
                                id="idAssetOriText"
                                text="{local>AssetOri}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id32Column"
                        width="16rem"
                        label="{i18n>MemoText}"
                    >
                        <t:template>
                            <Text
                                id="idMemoTextText"
                                text="{local>MemoText}"
                                tooltip="{local>MemoText}"
                                wrapping="false"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id33Column"
                        width="8rem"
                        label="{i18n>BuyPurpoose}"
                    >
                        <t:template>
                            <Text
                                id="idBuyPurpooseText"
                                text="{local>BuyPurpoose}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id39Column"
                        width="8rem"
                        label="{i18n>PurchaseOrder}"
                    >
                        <t:template>
                            <Text
                                id="idPurchaseOrderText"
                                text="{local>PurchaseOrder}"
                            />
                        </t:template>
                    </t:Column>
                    <t:Column
                        id="id40Column"
                        width="6rem"
                        label="{i18n>PurchaseOrderItem}"
                    >
                        <t:template>
                            <Text
                                id="idPurchaseOrderItemText"
                                text="{local>PurchaseOrderItem}"
                            />
                        </t:template>
                    </t:Column>
                    
                </t:columns>
            </t:Table>
        </Panel>
    </VBox>
</mvc:View>